---
title: "Get started"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Get started}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(meta.arrR)

# get starting values
starting_values <- meta.arrR::default_starting_values

starting_values$pop_n <- 3

# get paramters
parameters <- meta.arrR::default_parameters

parameters$nutrients_output <- 0.01

# create 5 reef cells in center of seafloor
reef_matrix <- matrix(data = c(-1, 0, 0, 1, 1, 0, 0, -1, 0, 0), 
                      ncol = 2, byrow = TRUE)

# setup extent and grain
extent <- c(50, 50)

grain <- 1

input_sys <- setup_meta(n = 3, extent = extent, grain = grain, reefs = reef_matrix, 
                        starting_values = starting_values, parameters = parameters)

# set time per iterations
min_per_i <- 120

# run the model for three years
years <- 3
max_i <- (60 * 24 * 365 * years) / min_per_i

# save results only every 15 days
days <- 5
save_each <- (24 / (min_per_i / 60)) * days

max_i %% save_each

nutr_input <- simulate_input_sine(n = 3, timestep = 1:max_i,
                                  period_mn = 0.0025, period_sd = 0.1, 
                                  amplitude_mn = 0.001, amplitude_sd = 0)

plot_nutrient_input(nutr_input)

result <- simulate_meta(metasyst = input_sys, nutr_input = nutr_input,
                        parameters = parameters, reef_attraction = FALSE,
                        max_i = max_i, save_each = save_each, min_per_i = min_per_i)

plot(result)
plot(result, summarize = TRUE)

# plot(result, what = "fishpop")
# plot(result, summarize = TRUE, what = "fishpop")

```
